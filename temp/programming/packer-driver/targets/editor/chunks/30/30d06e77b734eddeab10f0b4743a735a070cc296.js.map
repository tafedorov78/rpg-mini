{"version":3,"sources":["file:///Users/artemfedorov/Documents/dev/rpg-mini/assets/prefabs/bullet/scripts/BulletComponent.ts"],"names":["_decorator","Component","tween","v3","ccclass","property","BulletComponent","images","onLoad","setType","name","isLeft","node","children","forEach","child","active","getChildByName","setScale","animate","targetPosition","bulletName","callback","update","target","ratio","yOffset","newY","y","setPosition","position","x","z","time","to","onUpdate","call","start"],"mappings":";;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,E,OAAAA,E;;;;;;;;;OACvC;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;iCAGjBM,e,WADZF,OAAO,CAAC,iBAAD,C,gBAAR,MACaE,eADb,SACqCL,SADrC,CAC+C;AAAA;AAAA;AAAA,eAE3CM,MAF2C,GAE1B,EAF0B;AAAA;;AAIjCC,QAAAA,MAAM,GAAS;AACrB,eAAKC,OAAL,CAAa,GAAb;AACH;;AAGMA,QAAAA,OAAO,CAACC,IAAD,EAAeC,MAAM,GAAG,KAAxB,EAA+B;AACzC,eAAKC,IAAL,CAAUC,QAAV,CAAmBC,OAAnB,CAA4BC,KAAD,IAAW;AAClCA,YAAAA,KAAK,CAACC,MAAN,GAAe,KAAf;AACH,WAFD;AAIA,gBAAMJ,IAAI,GAAG,KAAKA,IAAL,CAAUK,cAAV,CAAyBP,IAAzB,CAAb;AACAE,UAAAA,IAAI,CAACI,MAAL,GAAc,IAAd;;AAEA,cAAIL,MAAJ,EAAY;AACRC,YAAAA,IAAI,CAACM,QAAL,CAAcf,EAAE,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,CAAhB;AACH;AACJ;;AAEMgB,QAAAA,OAAO,CAACC,cAAD,EAAuBC,UAAvB,EAA2CV,MAA3C,EAA4DW,QAA5D,EAAoG;AAC9G,eAAKb,OAAL,CAAaY,UAAb,EAAyBV,MAAzB;AAEA,gBAAMY,MAAM,GAAGF,UAAU,KAAK,GAAf,GACT,CAACG,MAAD,EAAeC,KAAf,KAAiC;AAC/B,kBAAMC,OAAO,GAAG,OAAO,IAAID,KAAJ,IAAa,IAAIA,KAAjB,CAAP,CAAhB;AACA,kBAAME,IAAI,GAAGP,cAAc,CAACQ,CAAf,GAAmBF,OAAhC;AACAF,YAAAA,MAAM,CAACK,WAAP,CAAmBL,MAAM,CAACM,QAAP,CAAgBC,CAAnC,EAAsCJ,IAAtC,EAA4CH,MAAM,CAACM,QAAP,CAAgBE,CAA5D;AACH,WALU,GAMT,IANN;AAQA,gBAAMC,IAAI,GAAGZ,UAAU,KAAK,GAAf,GAAqB,GAArB,GAA2B,GAAxC;AACAnB,UAAAA,KAAK,CAAC,KAAKU,IAAN,CAAL,CACKsB,EADL,CACQD,IADR,EACc;AAAEH,YAAAA,QAAQ,EAAEV;AAAZ,WADd,EAC4C;AACpCe,YAAAA,QAAQ,EAAEZ;AAD0B,WAD5C,EAIKa,IAJL,CAIU,MAAM;AACRd,YAAAA,QAAQ,CAAC,KAAKV,IAAN,CAAR;AACH,WANL,EAOKyB,KAPL;AAQH;;AA1C0C,O","sourcesContent":["import { _decorator, Component, Node, tween, v3, Vec3 } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('BulletComponent')\nexport class BulletComponent extends Component {\n\n    images: Node[] = [];\n\n    protected onLoad(): void {\n        this.setType('2');\n    }\n\n\n    public setType(name: string, isLeft = false) {\n        this.node.children.forEach((child) => {\n            child.active = false;\n        })\n\n        const node = this.node.getChildByName(name);\n        node.active = true;\n\n        if (isLeft) {\n            node.setScale(v3(-1, 1, 1));\n        }\n    }\n\n    public animate(targetPosition: Vec3, bulletName: string, isLeft: boolean, callback: (bullet: Node) => void): void {\n        this.setType(bulletName, isLeft);\n\n        const update = bulletName === '2'\n            ? (target: Node, ratio: number) => {\n                const yOffset = 100 * (4 * ratio * (1 - ratio));\n                const newY = targetPosition.y + yOffset;\n                target.setPosition(target.position.x, newY, target.position.z);\n            }\n            : null\n\n        const time = bulletName === '2' ? 0.8 : 0.5;\n        tween(this.node)\n            .to(time, { position: targetPosition }, {\n                onUpdate: update\n            })\n            .call(() => {\n                callback(this.node);\n            })\n            .start();\n    }\n}\n\n"]}